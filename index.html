<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Advanced Farming Simulator</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(to bottom, #a7d8a7, #3b7a3b);
    margin: 0;
    padding: 20px;
    color: #2f3e2f;
  }
  h1 {
    text-align: center;
    margin-bottom: 10px;
  }
  #game {
    max-width: 480px;
    margin: 0 auto;
  }
  #farm {
    display: grid;
    grid-template-columns: repeat(5, 70px);
    grid-gap: 6px;
    margin-bottom: 15px;
    user-select: none;
  }
  .plot {
    width: 70px;
    height: 70px;
    background: #7ba87b;
    border: 2px solid #4a7a4a;
    border-radius: 8px;
    position: relative;
    cursor: pointer;
    overflow: hidden;
    box-shadow: inset 0 4px 6px #9bc29b;
    transition: border-color 0.3s ease;
  }
  .plot.selected {
    border-color: #2f9e2f;
  }
  .plot.empty:hover {
    background: #8fcf8f;
  }
  .plot .crop {
    position: absolute;
    bottom: 4px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
    animation: sway 3s ease-in-out infinite;
  }
  .plot .watered-overlay {
    position: absolute;
    top: 3px;
    right: 3px;
    width: 16px;
    height: 16px;
    background: url('https://i.imgur.com/sjfTsEl.png') no-repeat center center;
    background-size: contain;
  }
  #info-panel {
    background: #d0efce;
    padding: 12px;
    border-radius: 10px;
    box-shadow: 0 0 10px #b1d3a8;
    margin-bottom: 15px;
  }
  #info-panel p {
    margin: 6px 0;
  }
  button, select {
    font-size: 16px;
    padding: 8px 12px;
    margin: 5px 3px 5px 0;
    border: none;
    border-radius: 6px;
    background-color: #4ca64c;
    color: white;
    cursor: pointer;
    box-shadow: 0 4px 0 #3b8b3b;
    transition: background-color 0.3s ease;
  }
  button:active {
    box-shadow: none;
    transform: translateY(2px);
  }
  button:disabled {
    background-color: #a4d2a4;
    cursor: not-allowed;
    box-shadow: none;
  }
  select {
    background-color: #6dbe6d;
  }
  #log {
    height: 120px;
    overflow-y: auto;
    background: #e7f3e7;
    border-radius: 8px;
    padding: 8px;
    font-size: 14px;
    box-shadow: inset 0 0 6px #b4ddb4;
    margin-top: 10px;
  }
  @keyframes sway {
    0%, 100% { transform: translateX(-50%) rotate(0deg); }
    50% { transform: translateX(-50%) rotate(3deg); }
  }
  @keyframes glow {
    0%, 100% { text-shadow: 0 0 7px #ffd700, 0 0 12px #ffd700; }
    50% { text-shadow: 0 0 15px #ffa500, 0 0 30px #ffa500; }
  }
  .ripe {
    animation: glow 2.5s ease-in-out infinite;
  }
  .seed-drop {
    position: absolute;
    bottom: 70%;
    font-size: 24px;
    animation: seedDrop 0.7s forwards;
    opacity: 1;
    pointer-events: none;
  }
  @keyframes seedDrop {
    0% { transform: translateY(-30px); opacity: 1; }
    100% { transform: translateY(0); opacity: 0; }
  }
</style>
</head>
<body>

<div id="game">
  <h1>Advanced Farming Simulator</h1>

  <div id="info-panel">
    <p><strong>Coins:</strong> <span id="coins">100</span></p>
    <p><strong>Seeds:</strong> Carrot(<span id="seed-carrot">5</span>), Wheat(<span id="seed-wheat">5</span>), Tomato(<span id="seed-tomato">5</span>)</p>
    <p><strong>Day:</strong> <span id="day">1</span> | <strong>Season:</strong> <span id="season">Spring</span> | <strong>Weather:</strong> <span id="weather">Sunny</span></p>
  </div>

  <div id="farm"></div>

  <div>
    <select id="cropSelect">
      <option value="carrot">Carrot (3 days, 10 coins)</option>
      <option value="wheat">Wheat (4 days, 15 coins)</option>
      <option value="tomato">Tomato (5 days, 20 coins)</option>
    </select>
    <button id="plantBtn">Plant</button>
    <button id="waterBtn">Water</button>
    <button id="harvestBtn">Harvest</button>
    <button id="waitBtn">Wait 1 Day</button>
    <button id="buySeedsBtn">Buy Seeds (10 coins each)</button>
  </div>

  <div id="log"></div>
</div>

<script>
  const farmSize = 5;
  let coins = 100;
  let seeds = { carrot: 5, wheat: 5, tomato: 5 };
  let day = 1;
  let season = "Spring";
  let weather = "Sunny";
  let farm = [];

  const cropsData = {
    carrot: { growTime: 3, value: 10, symbol: 'ü•ï' },
    wheat: { growTime: 4, value: 15, symbol: 'üåæ' },
    tomato: { growTime: 5, value: 20, symbol: 'üçÖ' },
  };

  const seasons = ["Spring", "Summer", "Autumn", "Winter"];
  const weatherOptions = {
    Spring: ["Sunny", "Rainy", "Cloudy"],
    Summer: ["Sunny", "Hot", "Rainy"],
    Autumn: ["Cloudy", "Windy", "Rainy"],
    Winter: ["Snowy", "Cloudy", "Sunny"]
  };

  // Initialize farm
  function initFarm() {
    const farmDiv = document.getElementById('farm');
    farmDiv.innerHTML = '';
    farm = [];
    for (let i = 0; i < farmSize * farmSize; i++) {
      farm.push({ crop: null, daysPlanted: 0, watered: false });
      const plot = document.createElement('div');
      plot.className = 'plot empty';
      plot.dataset.index = i;
      plot.addEventListener('click', () => selectPlot(i));
      farmDiv.appendChild(plot);
    }
  }

  let selectedPlot = null;
  function selectPlot(index) {
    selectedPlot = index;
    updateFarmDisplay();
    logMessage(`Plot ${index + 1} selected.`);
  }

  function animateSeedDrop(plotDiv) {
    const seed = document.createElement('div');
    seed.className = 'seed-drop';
    seed.textContent = 'üå±';
    plotDiv.appendChild(seed);
    setTimeout(() => {
      if(plotDiv.contains(seed)) plotDiv.removeChild(seed);
    }, 700);
  }

  function logMessage(msg) {
    const log = document.getElementById('log');
    const p = document.createElement('p');
    p.textContent = msg;
    log.prepend(p);
  }

  function updateFarmDisplay() {
    const farmDiv = document.getElementById('farm');
    farm.forEach((plot, i) => {
      const div = farmDiv.children[i];
      div.classList.remove('selected');
      div.innerHTML = '';
      if (plot.crop) {
        const cropData = cropsData[plot.crop];
        const ready = plot.daysPlanted >= cropData.growTime;
        const cropSpan = document.createElement('span');
        cropSpan.textContent = ready ? 'üåü' : cropData.symbol;
        cropSpan.className = 'crop';
        if (ready) cropSpan.classList.add('ripe');
        div.appendChild(cropSpan);

        if (plot.watered) {
          const waterIcon = document.createElement('div');
          waterIcon.className = 'watered-overlay';
          div.appendChild(waterIcon);
        }
        div.classList.remove('empty');
      } else {
        div.classList.add('empty');
      }
      if (i === selectedPlot) {
        div.classList.add('selected');
      }
    });

    document.getElementById('coins').textContent = coins;
    document.getElementById('seed-carrot').textContent = seeds.carrot;
    document.getElementById('seed-wheat').textContent = seeds.wheat;
    document.getElementById('seed-tomato').textContent = seeds.tomato;
    document.getElementById('day').textContent = day;
    document.getElementById('season').textContent = season;
    document.getElementById('weather').textContent = weather;
  }

  // Plant a crop
  function plantCrop() {
    if (selectedPlot === null) {
      alert('Select a plot to plant!');
      return;
    }
    if (farm[selectedPlot].crop) {
      alert('Plot already planted!');
      return;
    }
    const crop = document.getElementById('cropSelect').value;
    if (seeds[crop] <= 0) {
      alert(`No seeds left for ${crop}!`);
      return;
    }
    seeds[crop]--;
    farm[selectedPlot] = { crop: crop, daysPlanted: 0, watered: false };
    animateSeedDrop(document.getElementById('farm').children[selectedPlot]);
    logMessage(`Planted ${crop} in plot ${selectedPlot + 1}.`);
    updateFarmDisplay();
  }

  // Water a crop
  function waterCrop() {
    if (selectedPlot === null) {
      alert('Select a plot to water!');
      return;
    }
    if (!farm[selectedPlot].crop) {
      alert('No crop planted here!');
      return;
    }
    if (farm[selectedPlot].watered) {
      alert('Already watered today!');
      return;
    }
    farm[selectedPlot].watered = true;
    logMessage(`Watered crop in plot ${selectedPlot + 1}. Growth will be faster!`);
    updateFarmDisplay();
  }

  // Harvest a crop
  function harvestCrop() {
    if (selectedPlot === null) {
      alert('Select a plot to harvest!');
      return;
    }
    const plot = farm[selectedPlot];
    if (!plot.crop) {
      alert('No crop to harvest here!');
      return;
    }
    const cropData = cropsData[plot.crop];
    if (plot.daysPlanted < cropData.growTime) {
      alert('Crop is not ready yet!');
      return;
    }
    coins += cropData.value;
    logMessage(`Harvested ${plot.crop} from plot ${selectedPlot + 1}. Earned ${cropData.value} coins.`);
    farm[selectedPlot] = { crop: null, daysPlanted: 0, watered: false };
    updateFarmDisplay();
  }

  // Wait 1 day
  function waitOneDay() {
    day++;
    // Change season every 30 days
    if (day % 30 === 1) {
      const seasonIndex = Math.floor((day - 1) / 30) % seasons.length;
      season = seasons[seasonIndex];
      logMessage(`Season changed to ${season}!`);
    }

    // Random weather for the season
    const weatherList = weatherOptions[season];
    weather = weatherList[Math.floor(Math.random() * weatherList.length)];
    logMessage(`Weather today is ${weather}.`);

    farm.forEach(plot => {
      if (plot.crop) {
        let growthBonus = 1;
        if (plot.watered) growthBonus = 2;
        if (weather === 'Rainy') growthBonus = 3;
        plot.daysPlanted += growthBonus;
        plot.watered = false;

        // Random chance of pests damaging crop (5%)
        if (Math.random() < 0.05) {
          logMessage(`Oh no! Pests damaged a ${plot.crop}! It withers.`);
          plot.crop = null;
          plot.daysPlanted = 0;
          plot.watered = false;
        }
      }
    });

    updateFarmDisplay();
  }

  // Buy seeds
  function buySeeds() {
    if (coins < 10) {
      alert('Not enough coins to buy seeds!');
      return;
    }
    const crop = document.getElementById('cropSelect').value;
    coins -= 10;
    seeds[crop]++;
    logMessage(`Bought 1 ${crop} seed for 10 coins.`);
    updateFarmDisplay();
  }

  // Event listeners
  document.getElementById('plantBtn').addEventListener('click', plantCrop);
  document.getElementById('waterBtn').addEventListener('click', waterCrop);
  document.getElementById('harvestBtn').addEventListener('click', harvestCrop);
  document.getElementById('waitBtn').addEventListener('click', waitOneDay);
  document.getElementById('buySeedsBtn').addEventListener('click', buySeeds);

  initFarm();
  updateFarmDisplay();
</script>

</body>
</html>
